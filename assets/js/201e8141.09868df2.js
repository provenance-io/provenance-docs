"use strict";(self.webpackChunkprovenance_blockchain_developer_portal=self.webpackChunkprovenance_blockchain_developer_portal||[]).push([[3251],{529:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>c,metadata:()=>s,toc:()=>d});var o=t(5893),i=t(1151),a=t(8677);const c={},r="BlockVault Contracts",s={id:"pb/integrating/integrating-with-p8e/p8e-contract-execution-environment-p8e/p8e-contracts/index",title:"BlockVault Contracts",description:'<DocSubheader text="Developing and publishing BlockVault contracts for loan life cycle events"',source:"@site/docs/pb/integrating/integrating-with-p8e/p8e-contract-execution-environment-p8e/p8e-contracts/index.md",sourceDirName:"pb/integrating/integrating-with-p8e/p8e-contract-execution-environment-p8e/p8e-contracts",slug:"/pb/integrating/integrating-with-p8e/p8e-contract-execution-environment-p8e/p8e-contracts/",permalink:"/docs/pb/integrating/integrating-with-p8e/p8e-contract-execution-environment-p8e/p8e-contracts/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"documentationSidebar",previous:{title:"Configuring Replication",permalink:"/docs/pb/integrating/integrating-with-p8e/p8e-contract-execution-environment-p8e/deploying-the-encrypted-object-store/configuring-replication"},next:{title:"Onboard Loan Contract",permalink:"/docs/pb/integrating/integrating-with-p8e/p8e-contract-execution-environment-p8e/p8e-contracts/example-loan-contracts"}},l={},d=[{value:"BlockVault Gradle Plugin",id:"blockvault-gradle-plugin",level:2},{value:"Publishing via the BlockVault CEE API",id:"publishing-via-the-blockvault-cee-api",level:2},{value:"Local Environment",id:"local-environment",level:3},{value:"Test Environment",id:"test-environment",level:3},{value:"Production Environment",id:"production-environment",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"blockvault-contracts",children:"BlockVault Contracts"}),"\n","\n","\n",(0,o.jsx)(a.Y,{text:"Developing and publishing BlockVault contracts for loan life cycle events"}),"\n",(0,o.jsx)(n.p,{children:"Asset originators can technically get away with mastering a single BlockVault contract to simply onboard assets to Provenance, however, executing a single contract throughout the entire life cycle of an asset such as a mortgage would provide little utility. For that reason this guide will touch on a series of BlockVault contracts designed to onboard and update a mortgage as it goes through the flow of being onboarded and validated by a third party in preparation for sale to an investor."}),"\n",(0,o.jsx)(n.h2,{id:"blockvault-gradle-plugin",children:"BlockVault Gradle Plugin"}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["Having an understanding of the ",(0,o.jsx)(n.a,{href:"https://developer.provenance.io/docs/modules/metadata-module",children:"Provenance Metadata module"})," is strongly recommended."]})}),"\n",(0,o.jsxs)(n.p,{children:["In order to execute contracts with the ",(0,o.jsx)(n.a,{href:"https://github.com/provenance-io/p8e-scope-sdk",children:"Provenance Scope SDK"}),", the contracts must be published into your execution environment. The ",(0,o.jsx)(n.code,{children:"p8e-gradle-plugin"})," provides a set of tasks in order to accomplish just that. Publishing contracts performs the following high level actions in order to allow contracts to be executed:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["An uberjar is built which contains a set of contracts and all associated protobuf messages associated with those contracts. This uberjar is persisted to BlockVaults's encrypted ",(0,o.jsx)(n.a,{href:"https://github.com/provenance-io/object-store",children:"object store"}),". This allows BlockVault to later pull it and make use of a ",(0,o.jsx)(n.a,{href:"https://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html",children:"Class Loader"})," to load it at runtime."]}),"\n",(0,o.jsxs)(n.li,{children:["A concrete implementation of ",(0,o.jsx)(n.a,{href:"https://github.com/provenance-io/p8e-scope-sdk/blob/main/contract-base/src/main/kotlin/io/provenance/scope/contract/contracts/ContractHash.kt",children:"ContractHash"})," is generated and stored alongside your source code. Similarly, an implementation of ",(0,o.jsx)(n.a,{href:"https://github.com/provenance-io/p8e-scope-sdk/blob/main/contract-proto/src/main/kotlin/io/provenance/scope/contract/proto/ProtoHash.kt",children:"ProtoHash"})," is also generated. These classes will be built into the jars that are depended on by the loan onboarding service, or any other application that will execute contracts. These classes provide a mapping from P8eContracts and their associated protobuf messages to the hash of the uberjar they are contained within. Ultimately, the sdk will make use of these classes via the ",(0,o.jsx)(n.a,{href:"https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html",children:"service provider"})," facility."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"publishing-via-the-blockvault-cee-api",children:"Publishing via the BlockVault CEE API"}),"\n",(0,o.jsxs)(n.p,{children:["To make things easier, the ",(0,o.jsx)(n.code,{children:"p8e-CEE-API"})," exposes the ",(0,o.jsx)(n.code,{children:"p8e-gradle-plugin"})," functionality in a RESTful endpoint, allowing users to publish their own BlockVault contracts or pre-defined contracts into their own BlockVault environment. See the ",(0,o.jsx)(n.a,{href:"https://developer.provenance.io/docs/integrating/asset-originators-guide/loan-onboarding-service/api-specification#create-contract-specification",children:"Create Contract Specification"})," documentation on the API Specification page."]}),"\n",(0,o.jsx)(n.p,{children:"The inputs that remain the same no matter which environment you're working in include:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"account - the originator ID that will map to your key management solution"}),"\n",(0,o.jsx)(n.li,{children:"scopeId - UUID for the new scope created for this new contract specification"}),"\n",(0,o.jsx)(n.li,{children:"scopeSpecId - The ID of the Scope Specification associated with this contract"}),"\n",(0,o.jsx)(n.li,{children:"contractSpecId - UUID for the new contract specification"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"chainId"})," and ",(0,o.jsx)(n.code,{children:"nodeEndpoint"})," values depend on your environment."]}),"\n",(0,o.jsx)(n.h3,{id:"local-environment",children:"Local Environment"}),"\n",(0,o.jsxs)(n.p,{children:["These values depend on values set in the ",(0,o.jsx)(n.code,{children:"docker-compose.yml"})," and ",(0,o.jsx)(n.code,{children:"genesis.json"})," files, but they default to:"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"chainId"})," - chain-local"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"nodeEndpoint"})," - tcp://localhost:26657"]}),"\n",(0,o.jsx)(n.h3,{id:"test-environment",children:"Test Environment"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"chainId"})," - pio-testnet-1"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"nodeEndpoint"})," - Ask for appropriate node endpoint"]}),"\n",(0,o.jsx)(n.h3,{id:"production-environment",children:"Production Environment"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"chainId"})," - pio-mainnet-1"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"nodeEndpoint"})," - Ask for appropriate node endpoint"]})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},8677:(e,n,t)=>{t.d(n,{Y:()=>i});t(7294);var o=t(5893);const i=e=>{let{text:n}=e;return(0,o.jsx)("p",{className:"pb-5 mb-5 -mt-3 border-0 border-b border-b-gray-300 border-solid text-gray-500",children:n})}},1151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>c});var o=t(7294);const i={},a=o.createContext(i);function c(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);